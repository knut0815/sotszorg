function drawTopScatter2(e,t,r){function a(e){return e.ZZP5_10_Perc_Groei>-.5&e.AANT_INW_2020>5e3?!0:!1}var l=gemeentes.filter(a),o=d3.scale.log().range([0,e]).domain([5e3,1e6]),n=d3.svg.axis().orient("bottom").scale(o).tickFormat(function(e){return o.tickFormat(mobileScreen?3:8,function(e){var t=d3.formatPrefix(e);return t.scale(e)+t.symbol})(e)}),c=d3.scale.linear().range([t,0]).domain(d3.extent(l,function(e){return e.ZZP5_10_Perc_Groei})).nice(),i=d3.scale.sqrt().range([0,mobileScreen?10:20]).domain([0,d3.max(l,function(e){return e.ZZP5_10_2020})]);drawScatter(l=l,wrapper=chartTop2,e,t,r,o,c,i,n,xVar="AANT_INW_2020",yVar="ZZP5_10_Perc_Groei",rVar="ZZP5_10_2020",colorVar="#00A1DE",chartTitle="Overzicht van gemeentes",xLabel="Aantal inwoners verwacht in 2020 | [LET OP: Logarithmische schaal]",yLabel="Ontwikkeling zware intramurale zorg"),chartTop2.append("line").attr("x1",o.range()[0]).attr("x2",o.range()[1]).attr("y1",c(0)).attr("y2",c(0)).style("stroke","#B5B5B5").style("shape-rendering","crispEdges").style("stroke-dasharray","2 2").style("pointer-events","none"),mobileScreen||(chartTop2.append("text").attr("class","legendText").attr("transform","translate(15,"+c(.04)+") rotate(-90)").style("text-anchor","start").style("font-size","11px").text("Toename"),chartTop2.append("text").attr("class","legendText").attr("transform","translate(15,"+c(-.04)+") rotate(-90)").style("text-anchor","end").style("font-size","11px").text("Afname"));var s=chartTop2.append("g").attr("class","legendWrapper").attr("transform","translate("+(scatterWidth-10)+","+(mobileScreen?-20:15)+")");if(bubbleLegend(s,i,legendSizes=[5e3,1e3,100],legendName="Zware intramurale zorgaanbod"),!mobileScreen){var p=chartTop2.append("g").attr("class","legendWrapper").attr("transform","translate("+(scatterWidth-110)+",15)");p.append("text").attr("class","legendTitle").attr("transform","translate(0,-25)").attr("x","0px").attr("y","0px").attr("dy","1em").text("Elke cirkel is een gemeente").call(wrap,80),p.append("circle").attr("r",i(2e3)).attr("class","legendCircle").attr("cx",0).attr("cy",i(2e3)+7)}}function drawBottomScatter2(e,t,r){var a=zorgkantoor,l=d3.scale.linear().range([0,e]).domain([0,15e5]),o=d3.svg.axis().orient("bottom").scale(l).ticks(6).tickFormat(d3.format("s")),n=d3.scale.linear().range([t,0]).domain(d3.extent(a,function(e){return e.ZZP5_10_Perc_Groei})).nice(),c=d3.scale.sqrt().range([0,mobileScreen?10:20]).domain([0,d3.max(a,function(e){return e.ZZP5_10_2020})]);drawScatter(a=a,wrapper=chartBottom2,e,t,r,l,n,c,o,xVar="AANT_INW_2020",yVar="ZZP5_10_Perc_Groei",rVar="ZZP5_10_2020",colorVar="#00A1DE",chartTitle="Overzicht van zorgkantoorregio's",xLabel="Aantal inwoners verwacht in 2020",yLabel="Ontwikkeling zware intramurale zorg");var i=chartBottom2.append("g").attr("class","legendWrapper").attr("transform","translate("+(scatterWidth-10)+","+(mobileScreen?-20:15)+")");if(bubbleLegend(i,c,legendSizes=[1e4,4e3,2e3],legendName="Zware intramurale zorgaanbod"),!mobileScreen){var s=chartBottom2.append("g").attr("class","legendWrapper").attr("transform","translate("+(scatterWidth-110)+",15)");s.append("text").attr("class","legendTitle").attr("transform","translate(0,-25)").attr("x","0px").attr("y","0px").attr("dy","1em").text("Elke cirkel is een zorgkantoor regio").call(wrap,90),s.append("circle").attr("r",c(3e3)).attr("class","legendCircle").attr("cx",0).attr("cy",c(3e3)+7)}}function searchEventHighZZP(e){""!=e?fadeIn2(e):fadeOut2()}function fadeIn2(e){if("string"==typeof e){var t=!1,r={GM_NAAM:e,GM_CODE:GM_NAMES[e]},a=d3.select(".circleScatter.gemeente."+r.GM_CODE).data()[0];clusterLegendWrapper2.select(".legendTitle.greenSquare").text("Gekozen gemeente"),clusterLegendWrapper2.select(".legendTitle.darkblueSquare").text("Bijbehorende zorgkantoor regio - In onderste cirkel plot"),clusterLegendWrapper2.select(".legendTitle.lightblueSquare").text("Vergelijkbare gemeentes, o.b.v:"),clusterLegendWrapper2.select(".legendRect.lightblueSquare").style("opacity",.4),clusterLegendWrapper2.select(".legendTitle.legendSub").style("opacity",1)}else if(hasClass(d3.select(this),"gemeente")){var t=chartTop2,r=e,l=".dataresource.zzp5_10.chartTop",o=e.GM_NAAM,n=chartTop2.selectAll(".circleScatter.gemeente."+e.GM_CODE),a=r;clusterLegendWrapper2.select(".legendTitle.greenSquare").text("Gekozen gemeente"),clusterLegendWrapper2.select(".legendTitle.darkblueSquare").text("Bijbehorende zorgkantoor regio - In onderste cirkel plot"),clusterLegendWrapper2.select(".legendTitle.lightblueSquare").text("Vergelijkbare gemeentes, o.b.v:"),clusterLegendWrapper2.select(".legendRect.lightblueSquare").style("opacity",.4),clusterLegendWrapper2.select(".legendTitle.legendSub").style("opacity",1)}else if(hasClass(d3.select(this),"zorgkantoor")){var t=chartBottom2,r=e,l=".dataresource.zzp5_10.chartBottom",o=e.Zorgkantoor,n=chartBottom2.selectAll(".circleScatter.zorgkantoor.ZC"+e.Zorgkantoorcode),a=void 0;clusterLegendWrapper2.select(".legendTitle.greenSquare").text("Gekozen zorgkantoor regio"),clusterLegendWrapper2.select(".legendTitle.darkblueSquare").text("Bijbehorende gemeentes - In bovenste cirkel plot"),clusterLegendWrapper2.select(".legendTitle.lightblueSquare").text(""),clusterLegendWrapper2.select(".legendRect.lightblueSquare").style("opacity",0),clusterLegendWrapper2.select(".legendTitle.legendSub").style("opacity",0)}else{var t=!1,r=e.properties,a=d3.select(".circleScatter.gemeente."+r.GM_CODE).data()[0];clusterLegendWrapper2.select(".legendTitle.greenSquare").text("Gekozen gemeente"),clusterLegendWrapper2.select(".legendTitle.darkblueSquare").text("Bijbehorende zorgkantoor regio - In onderste cirkel plot"),clusterLegendWrapper2.select(".legendTitle.lightblueSquare").text("Vergelijkbare gemeentes, o.b.v:"),clusterLegendWrapper2.select(".legendRect.lightblueSquare").style("opacity",.4),clusterLegendWrapper2.select(".legendTitle.legendSub").style("opacity",1)}var c=[];void 0!=a&&gemeentes.forEach(function(e){if(e.perc_rental===a.perc_rental&e.city_level===a.city_level&e.common_age===a.common_age&e.common_income===a.common_income)if(3===a.city_level&(e.AANT_INW<a.AANT_INW-1e4|e.AANT_INW>a.AANT_INW+1e4));else c.push(e.GM_CODE)}),void 0!=o&&($(n).popover({placement:"auto top",container:l,trigger:"manual",html:!0,content:function(){return"<p style='font-size: 11px; text-align: center;'>"+o+"</p>"}}),$(n).popover("show")),0!=t&&(t.append("g").attr("class","guide").append("line").attr("x1",n.attr("cx")).attr("x2",n.attr("cx")).attr("y1",+n.attr("cy")).attr("y2",scatterHeight+10).style("stroke","#81BC00").style("opacity",0).style("pointer-events","none").transition().duration(400).style("opacity",.5),t.append("g").attr("class","guide").append("line").attr("x1",+n.attr("cx")).attr("x2",0).attr("y1",n.attr("cy")).attr("y2",n.attr("cy")).style("stroke","#81BC00").style("opacity",0).style("pointer-events","none").transition().duration(400).style("opacity",.5)),"string"==typeof e?(mapCallout2.selectAll("#callout_title").text(r.GM_NAAM),void 0===GM_CODES[r.GM_CODE]?(mapCallout2.selectAll("#callout_top").text("-"),mapCallout2.selectAll("#callout_bottom").text("-")):(mapCallout2.selectAll("#callout_top").text(numFormatThousands(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_2020)),mapCallout2.selectAll("#callout_bottom").text(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei>0?"+"+numFormatPercentDec(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei):numFormatPercentDec(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei))),map2.selectAll("path").style("fill",function(e){return e.properties.GM_CODE==r.GM_CODE?"#81BC00":$.inArray(e.properties.GM_CODE,c)>-1?"#00A1DE":"#A3A3A3"}).style("opacity",function(e){return $.inArray(e.properties.GM_CODE,c),e.properties.GM_CODE==r.GM_CODE?1:$.inArray(e.properties.GM_CODE,c)>-1?.4:.2}),chartTop2.selectAll(".circleScatter.gemeente").style("fill",function(e){return e.GM_CODE==r.GM_CODE?"#81BC00":"#00A1DE"}).style("opacity",function(e){return $.inArray(e.GM_CODE,c),e.GM_CODE==r.GM_CODE?1:$.inArray(e.GM_CODE,c)>-1?.4:.02}),chartBottom2.selectAll(".circleScatter.zorgkantoor").style("opacity",function(e){return e.Zorgkantoorcode==zorgkantoorById[r.GM_CODE]?1:.1})):hasClass(d3.select(this),"gemeente")?(mapCallout2.selectAll("#callout_title").text(r.GM_NAAM),mapCallout2.selectAll("#callout_top").text(numFormatThousands(r.ZZP5_10_2020)),mapCallout2.selectAll("#callout_bottom").text(r.ZZP5_10_Perc_Groei>0?"+"+numFormatPercentDec(r.ZZP5_10_Perc_Groei):numFormatPercentDec(r.ZZP5_10_Perc_Groei)),map2.selectAll("path").style("fill",function(e){return e.properties.GM_CODE==r.GM_CODE?"#81BC00":$.inArray(e.properties.GM_CODE,c)>-1?"#00A1DE":"#A3A3A3"}).style("opacity",function(e){return $.inArray(e.properties.GM_CODE,c),e.properties.GM_CODE==r.GM_CODE?1:$.inArray(e.properties.GM_CODE,c)>-1?.4:.2}),chartTop2.selectAll(".circleScatter.gemeente").style("fill",function(e){return e.GM_CODE==r.GM_CODE?"#81BC00":"#00A1DE"}).style("opacity",function(e){return $.inArray(e.GM_CODE,c),e.GM_CODE==r.GM_CODE?1:$.inArray(e.GM_CODE,c)>-1?.4:.02}),chartBottom2.selectAll(".circleScatter.zorgkantoor").style("opacity",function(e){return e.Zorgkantoorcode==r.Zorgkantoorcode?1:.2})):hasClass(d3.select(this),"zorgkantoor")?(mapCallout2.selectAll("#callout_title").text(r.Zorgkantoor),mapCallout2.selectAll("#callout_top").text(numFormatThousands(10*Math.ceil(r.ZZP5_10_2020/10))),mapCallout2.selectAll("#callout_bottom").text(r.ZZP5_10_Perc_Groei>0?"+"+numFormatPercentDec(r.ZZP5_10_Perc_Groei):numFormatPercentDec(r.ZZP5_10_Perc_Groei)),map2.selectAll("path").style("opacity",.2),map2.selectAll("path").filter(function(e){return zorgkantoorById[e.properties.GM_CODE]==r.Zorgkantoorcode}).style("opacity",1),chartTop2.selectAll(".circleScatter.gemeente").style("opacity",function(e){return e.Zorgkantoorcode==r.Zorgkantoorcode?1:.04}),chartBottom2.selectAll(".circleScatter.zorgkantoor").style("fill",function(e){return e.Zorgkantoorcode==r.Zorgkantoorcode?"#81BC00":"#00A1DE"}).style("opacity",function(e){return e.Zorgkantoorcode==r.Zorgkantoorcode?1:.1})):(mapCallout2.selectAll("#callout_title").text(r.GM_NAAM),void 0===GM_CODES[e.properties.GM_CODE]?(mapCallout2.selectAll("#callout_top").text("-"),mapCallout2.selectAll("#callout_bottom").text("-")):(mapCallout2.selectAll("#callout_top").text(numFormatThousands(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_2020)),mapCallout2.selectAll("#callout_bottom").text(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei>0?"+"+numFormatPercentDec(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei):numFormatPercentDec(gemeentes[GM_CODES[r.GM_CODE]].ZZP5_10_Perc_Groei))),map2.selectAll("path").style("fill",function(e){return e.properties.GM_CODE==r.GM_CODE?"#81BC00":$.inArray(e.properties.GM_CODE,c)>-1?"#00A1DE":"#A3A3A3"}).style("opacity",function(e){return $.inArray(e.properties.GM_CODE,c),e.properties.GM_CODE==r.GM_CODE?1:$.inArray(e.properties.GM_CODE,c)>-1?.4:.2}),chartTop2.selectAll(".circleScatter.gemeente").style("fill",function(e){return e.GM_CODE==r.GM_CODE?"#81BC00":"#00A1DE"}).style("opacity",function(e){return $.inArray(e.GM_CODE,c),e.GM_CODE==r.GM_CODE?1:$.inArray(e.GM_CODE,c)>-1?.4:.02}),chartBottom2.selectAll(".circleScatter.zorgkantoor").style("opacity",function(e){return e.Zorgkantoorcode==zorgkantoorById[r.GM_CODE]?1:.2})),mapCallout2.style("visibility","visible"),mapLegendWrapper2.style("visibility","hidden"),clusterLegendWrapper2.style("visibility","visible")}function fadeOut2(){mapLegendWrapper2.style("visibility","visible"),clusterLegendWrapper2.style("visibility","hidden"),mapCallout2.style("visibility","hidden"),map2.selectAll("path").style("opacity",1).style("fill",function(e){return void 0===GM_CODES[e.properties.GM_CODE]?"#DCDCDC":color2(gemeentes[GM_CODES[e.properties.GM_CODE]].ZZP5_10_Perc_Groei)}),chartTop2.selectAll(".circleScatter").style("fill","#00A1DE").style("opacity",.6),chartBottom2.selectAll(".circleScatter").style("fill","#00A1DE").style("opacity",.6),d3.selectAll(".guide").transition().duration(100).style("opacity",0).remove(),$(".popover").each(function(){$(this).remove()})}var svgChartTop2=d3.select(".dataresource.zzp5_10.chartTop").append("svg").attr("width",scatterWidth+scatterMargin.left+scatterMargin.right).attr("height",scatterHeight+scatterMargin.top+scatterMargin.bottom),svgChartBottom2=d3.select(".dataresource.zzp5_10.chartBottom").append("svg").attr("width",scatterWidth+scatterMargin.left+scatterMargin.right).attr("height",scatterHeight+scatterMargin.top+scatterMargin.bottom),chartTop2=svgChartTop2.append("g").attr("class","chartZZP5_10").attr("transform","translate("+scatterMargin.left+","+scatterMargin.top+")"),chartBottom2=svgChartBottom2.append("g").attr("class","chartZZP5_10").attr("transform","translate("+scatterMargin.left+","+scatterMargin.top+")"),svgMap2=d3.select(".dataresource.zzp5_10.map").append("svg").attr("width",mapWidth+scatterMargin.left+scatterMargin.right).attr("height",mapHeight+scatterMargin.top+scatterMargin.bottom),map2=svgMap2.append("g").attr("class","map").attr("transform","translate("+scatterMargin.left+","+scatterMargin.top+")"),mapCallout2=svgMap2.append("g").attr("class","mapCallout").attr("transform","translate("+scatterMargin.left+","+5*scatterMargin.top/4+")").style("visibility","hidden"),mapLegendWrapper2=svgMap2.append("g").attr("class","legend"),clusterLegendWrapper2=svgMap2.append("g").attr("class","legend");drawTopScatter2(scatterWidth,scatterHeight,scatterMargin),drawBottomScatter2(scatterWidth,scatterHeight,scatterMargin),drawMap(mapWrapper=map2,chartClass="chartZZP5_10",colorScale=color2,colorVar="ZZP5_10_Perc_Groei",mapTitle="De ontwikkeling van de zware intramurale zorg per gemeente",width=mapWidth,height=mapHeight,margin=scatterMargin),drawHistoLegend(data=gemeentes,width=mapWidth,height=mapHeight,margin=scatterMargin,colorScale=color2,xVar="ZZP5_10_Perc_Groei",wrapper=mapLegendWrapper2,title="Af- of toename van het zware intramurale zorgaanbod tot 2020",yoff=30),drawClusterLegend(wrapper=clusterLegendWrapper2,width=mapWidth,height=mapHeight,margin=scatterMargin),drawCallout(calloutWrapper=mapCallout2,topText="Aanbod zware intramurale zorg in 2020",bottomText="Ontwikkeling tot 2020");for(var options=allGemeentes,select=document.getElementById("searchBoxHighZZP"),i=0;i<options.length;i++){var opt=options[i],el=document.createElement("option");el.textContent=opt,el.value=opt,select.appendChild(el)}$(".combobox").combobox();